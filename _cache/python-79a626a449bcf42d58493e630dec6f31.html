<div class="highlight"><pre><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_17&quot;</span><span class="o">&gt;</span><span class="n">url</span> <span class="n">to</span> <span class="n">get</span> <span class="n">access</span> <span class="n">token</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">access_token_url</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;http://www.flickr.com/services/oauth/access_token&quot;</span><span class="o">&gt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">flickr</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">oauth</span><span class="o">/</span><span class="n">access_token</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_18&quot;</span><span class="o">&gt;</span><span class="n">Now</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">exchange</span> <span class="n">your</span> <span class="n">Request</span> <span class="n">Token</span> <span class="k">for</span> <span class="n">an</span> <span class="n">Access</span> <span class="n">Token</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_19&quot;</span><span class="o">&gt;</span><span class="n">Set</span> <span class="n">the</span> <span class="n">base</span> <span class="n">oauth_</span><span class="o">*</span> <span class="n">parameters</span> <span class="n">along</span> <span class="k">with</span> <span class="nb">any</span> <span class="n">other</span> <span class="n">parameters</span> <span class="n">required</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_20&quot;</span><span class="o">&gt;</span><span class="k">for</span> <span class="n">the</span> <span class="n">API</span> <span class="n">call</span><span class="o">.&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">access_token_parms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">&amp;</span><span class="c">#39;oauth_consumer_key&amp;#39;: keys.apikey,</span>
    <span class="o">&amp;</span><span class="c">#39;oauth_nonce&amp;#39;: oauth.generate_nonce(),</span>
    <span class="o">&amp;</span><span class="c">#39;oauth_signature_method&amp;#39;:&amp;quot;HMAC-SHA1&amp;quot;,</span>
    <span class="o">&amp;</span><span class="c">#39;oauth_timestamp&amp;#39;: str(int(time.time())),</span>
    <span class="o">&amp;</span><span class="c">#39;oauth_token&amp;#39;:request_token[&amp;#39;oauth_token&amp;#39;],</span>
    <span class="o">&amp;</span><span class="c">#39;oauth_verifier&amp;#39; : oauth_verifier</span>
<span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_21&quot;</span><span class="o">&gt;</span><span class="n">setup</span> <span class="n">request</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">req</span> <span class="o">=</span> <span class="n">oauth</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">method</span><span class="o">=&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">GET</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">url</span><span class="o">=</span><span class="n">access_token_url</span><span class="p">,</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">access_token_parms</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_22&quot;</span><span class="o">&gt;</span><span class="n">create</span> <span class="n">the</span> <span class="n">signature</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">signature</span> <span class="o">=</span> <span class="n">oauth</span><span class="o">.</span><span class="n">SignatureMethod_HMAC_SHA1</span><span class="p">()</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">req</span><span class="p">,</span><span class="n">consumer</span><span class="p">,</span><span class="n">token</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_23&quot;</span><span class="o">&gt;</span><span class="n">assign</span> <span class="n">the</span> <span class="n">signature</span> <span class="n">to</span> <span class="n">the</span> <span class="n">request</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">req</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;oauth_signature&amp;#39;] = signature&lt;/p&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_24&quot;</span><span class="o">&gt;</span><span class="n">make</span> <span class="n">the</span> <span class="n">request</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">h</span> <span class="o">=</span> <span class="n">httplib2</span><span class="o">.</span><span class="n">Http</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">.</span><span class="n">cache</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">resp</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">to_url</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">GET</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_25&quot;</span><span class="o">&gt;</span><span class="n">parse</span> <span class="n">the</span> <span class="n">response</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">access_token_resp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">urlparse</span><span class="o">.</span><span class="n">parse_qsl</span><span class="p">(</span><span class="n">content</span><span class="p">))</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">h1</span> <span class="nb">id</span><span class="o">=</span><span class="s">&quot;toc_26&quot;</span><span class="o">&gt;</span><span class="n">write</span> <span class="n">out</span> <span class="n">a</span> <span class="nb">file</span> <span class="k">with</span> <span class="n">the</span> <span class="n">oauth_token</span> <span class="ow">and</span> <span class="n">oauth_token_secret</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="o">&amp;</span><span class="c">#39;token&amp;#39;, &amp;#39;w&amp;#39;) as f:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">access_token_resp</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;oauth_token&amp;#39;] + &amp;#39;\n&amp;#39;)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">access_token_resp</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;oauth_token_secret&amp;#39;])</span>
<span class="n">f</span><span class="o">.</span><span class="n">closed</span>
</pre></div>