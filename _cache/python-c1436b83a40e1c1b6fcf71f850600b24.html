<div class="highlight"><pre><span class="k">if</span> <span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">name</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="o">==</span> <span class="o">&amp;</span><span class="c">#39;&lt;strong&gt;main&lt;/strong&gt;&amp;#39;:&lt;/p&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">#Read the Config File to get the twitter keys and tokens</span>
  <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">RawConfigParser</span><span class="p">()</span>
  <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="o">&amp;</span><span class="c">#39;settings.cfg&amp;#39;)&lt;/p&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">#method, url and parameters to call</span>
  <span class="n">method</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">get</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>
  <span class="n">url</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://api.twitter.com/1.1/statuses/user_timeline.json&quot;</span><span class="o">&gt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mf">1.1</span><span class="o">/</span><span class="n">statuses</span><span class="o">/</span><span class="n">user_timeline</span><span class="o">.</span><span class="n">json</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;&amp;</span><span class="n">quot</span><span class="p">;</span>
  <span class="n">url_parameters</span> <span class="o">=</span> <span class="p">{</span>
      <span class="o">&amp;</span><span class="c">#39;exclude_replies&amp;#39;: &amp;#39;true&amp;#39;</span>
  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">#configuration hash for the keys</span>
  <span class="n">keys</span> <span class="o">=</span> <span class="p">{</span>
      <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">twitter_consumer_secret</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
          <span class="o">&amp;</span><span class="c">#39;Keys&amp;#39;, &amp;#39;twitter_consumer_secret&amp;#39;),</span>
      <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">twitter_consumer_key</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="c">#39;Keys&amp;#39;, &amp;#39;twitter_consumer_key&amp;#39;),</span>
      <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">access_token</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="c">#39;Keys&amp;#39;, &amp;#39;access_token&amp;#39;),</span>
      <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">access_token_secret</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="c">#39;Keys&amp;#39;, &amp;#39;access_token_secret&amp;#39;)</span>
  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">oauth_parameters</span> <span class="o">=</span> <span class="n">get_oauth_parameters</span><span class="p">(</span>
      <span class="n">keys</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;twitter_consumer_key&amp;#39;],</span>
      <span class="n">keys</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;access_token&amp;#39;]</span>
  <span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">oauth_parameters</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;oauth_signature&amp;#39;] = generate_signature(</span>
      <span class="n">method</span><span class="p">,</span>
      <span class="n">url</span><span class="p">,</span>
      <span class="n">url_parameters</span><span class="p">,</span> <span class="n">oauth_parameters</span><span class="p">,</span>
      <span class="n">keys</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;twitter_consumer_key&amp;#39;],</span>
      <span class="n">keys</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;twitter_consumer_secret&amp;#39;],</span>
      <span class="n">keys</span><span class="p">[</span><span class="o">&amp;</span><span class="c">#39;access_token_secret&amp;#39;]</span>
  <span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="o">&amp;</span><span class="c">#39;Authorization&amp;#39;: create_auth_header(oauth_parameters)}&lt;/p&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">url</span> <span class="o">+=</span> <span class="o">&amp;</span><span class="c">#39;?&amp;#39; + urllib.urlencode(url_parameters)&lt;/p&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">print</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>